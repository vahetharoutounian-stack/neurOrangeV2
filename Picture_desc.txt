<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no, maximum-scale=1" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<title>neurOrange • Deep Research Gallery (No “Description coming soon”)</title>

<!-- ====== STYLES ====== -->
<style>
  :root{
    --glass: rgba(0,0,0,.28);
    --gap: clamp(24px,7vw,72px);
    --basis: 21%;
    --scaleCenter: 1.6;
    --scaleSide: .80;
    --rowH: 22vh;
  }
  html,body{
    margin:0;background:#000;color:#fff;
    -webkit-font-smoothing:antialiased;
    font-family:ui-sans-serif,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  }
  #stage{position:fixed;inset:0;display:grid;place-items:center;
    padding:env(safe-area-inset-top) env(safe-area-inset-right)
            env(safe-area-inset-bottom) env(safe-area-inset-left)}
  #frame{
    position:relative;height:100dvh;width:min(100dvw,calc(100dvh*9/16));
    border-radius:18px;overflow:hidden;border:1px solid rgba(255,255,255,.08);
    background:#000;box-shadow:0 20px 80px rgba(0,0,0,.55)
  }
  /* optional background (add gallery.jpg next to this file) */
  #frame::before{content:"";position:absolute;inset:0;z-index:0;
    background:url("gallery.jpg") center/auto 100% no-repeat;
    filter:saturate(105%) brightness(95%)}

  #content{position:relative;z-index:1;height:100%;display:flex;flex-direction:column;gap:10px;padding:0 0 10px}

  /* carousel */
  .carousel{position:relative;height:var(--rowH);background:var(--glass);
    backdrop-filter:blur(6px);-webkit-backdrop-filter:blur(6px);
    border-radius:12px;border:1px solid rgba(255,255,255,.08);overflow:hidden}
  #track{position:relative;height:100%;display:flex;align-items:center;gap:var(--gap);
    overflow-x:auto;overflow-y:hidden;-webkit-overflow-scrolling:touch;scroll-behavior:smooth;
    scroll-snap-type:x mandatory;scroll-snap-stop:always;padding:0 var(--gap);scrollbar-width:none;touch-action:pan-x;cursor:grab}
  #track::-webkit-scrollbar{display:none}
  .spacer{flex:0 0 60%;height:1px}
  .card{flex:0 0 var(--basis);height:calc(100%/var(--scaleCenter));scroll-snap-align:center;
    display:flex;align-items:center;justify-content:center;transform:scale(var(--scaleSide));
    transition:transform .18s ease,z-index .18s ease,filter .18s ease;position:relative;border-radius:12px}
  .card img{max-height:100%;width:auto;height:auto;object-fit:contain;display:block;-webkit-user-drag:none;user-select:none;background:#0b0b0c;border-radius:12px;filter:drop-shadow(0 0 28px rgba(0,0,0,.95)) drop-shadow(0 0 52px rgba(0,0,0,.75))}
  .card.ph{background:linear-gradient(135deg,#1d1d1d,#2b2b2b);border:1px dashed rgba(255,255,255,.18);color:#ccc;text-align:center;padding:10px}

  /* caption */
  #desc{width:70%;margin:8px auto 0;min-height:4.6vh;max-height:10vh;padding:6px 10px;font-size:13.25px;line-height:1.35;color:#f2f2f2;background:var(--glass);
    backdrop-filter:blur(6px);-webkit-backdrop-filter:blur(6px);border-radius:12px;border:1px solid rgba(255,255,255,.08)}
  #desc .head{font-weight:700;margin-bottom:2px}
  #desc .body{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;text-align:justify}

  /* modal */
  #modal{position:fixed;inset:0;display:none;overflow:hidden;background:rgba(0,0,0,.88);color:#fff;z-index:9990}
  #modal.show{display:block}
  #mWrap{position:absolute;inset:env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
    display:flex;flex-direction:column;align-items:center;justify-content:center;padding:12px}
  #mImg{max-width:94vw;max-height:60vh;border:2px solid #fff;border-radius:12px;margin-bottom:8px}
  #mMeta{max-width:94vw}
  #mTitle{font-weight:800;margin:6px 0 4px;font-size:18px;line-height:1.25}
  #mLong{max-height:32vh;overflow:auto;-webkit-overflow-scrolling:touch;font-size:15px;line-height:1.55;text-align:justify}

  /* swatches like Color Library */
  #swatches{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
  #swatches .sw{position:relative;width:44px;height:44px;border-radius:12px;border:2px solid #fff;overflow:hidden;box-shadow:0 2px 10px rgba(0,0,0,.25) inset}
  #swatches .sw i{position:absolute;inset:0;border-radius:inherit;border:0}
  #swatches .sw::before,#swatches .sw::after{content:"";position:absolute;background:#222;opacity:.85}
  #swatches .sw::before{width:1px;height:60%;left:50%;top:20%;transform:translateX(-.5px)}
  #swatches .sw::after{height:1px;width:60%;top:50%;left:20%;transform:translateY(-.5px)}
</style>
</head>
<body>
<div id="stage"><div id="frame"><div id="content">
  <div class="carousel"><div id="track"></div></div>
  <div id="desc" aria-live="polite"></div>
</div></div></div>

<!-- fullscreen modal -->
<div id="modal" role="dialog" aria-modal="true">
  <div id="mWrap">
    <img id="mImg" alt="">
    <div id="mMeta">
      <div id="mTitle"></div>
      <div id="mLong"></div>
      <div id="swatches"></div>
    </div>
  </div>
</div>

<!-- ====== APP SCRIPT ====== -->
<script>
/* 12 paintings — Monet first. If your files are Turner-first, swap the first two. */
const PAINTINGS = [
  {src:'paintings/1.jpg',  title:'Impression, Sunrise',                 artist:'Claude Monet',              year:'1872'},
  {src:'paintings/2.jpg',  title:'The Fighting Temeraire',               artist:'J. M. W. Turner',           year:'1839'},
  {src:'paintings/3.jpg',  title:'Orange and Yellow',                    artist:'Mark Rothko',               year:'1956'},
  {src:'paintings/4.jpg',  title:'South Wind, Clear Sky',                artist:'Katsushika Hokusai',        year:'c. 1830'},
  {src:'paintings/5.jpg',  title:'Red Canna',                            artist:'Georgia O’Keeffe',          year:'1924'},
  {src:'paintings/6.jpg',  title:'Composition VIII',                     artist:'Wassily Kandinsky',         year:'1923'},
  {src:'paintings/7.jpg',  title:'Synchromy in Orange: To Form',         artist:'Stanton MacDonald-Wright',  year:'1914'},
  {src:'paintings/8.jpg',  title:'Target with Four Faces',               artist:'Jasper Johns',              year:'1955'},
  {src:'paintings/9.jpg',  title:'Beginning',                            artist:'Kenneth Noland',            year:'1958'},
  {src:'paintings/10.jpg', title:'The Night Café',                       artist:'Vincent van Gogh',          year:'1888'},
  {src:'paintings/11.jpg', title:'Bedroom in Arles',                     artist:'Vincent van Gogh',          year:'1889'},
  {src:'paintings/12.jpg', title:'Flaming June',                         artist:'Frederic Leighton',         year:'1895'}
];

/* ------- canonicalizer + aliases (robust matching) ------- */
const canon = s => s.toLowerCase()
  .normalize('NFD').replace(/\p{Diacritic}/gu,'')
  .replace(/[^a-z0-9 ]+/g,' ')
  .replace(/\s+/g,' ')
  .trim();

const ALIAS = {
  'red canna':'canna red and orange',
  'the night cafe':'the night café',
  'south wind, clear sky (red fuji)':'south wind, clear sky',
  'red fuji':'south wind, clear sky'
};

/* ------- authoritative description map (prevents “Description coming soon”) ------- */
/* You can edit these, and/or override them by adding a Picture_desc.txt at repo root */
const DESCRIPTIONS = (() => {
  const d = {};

  // helper to add entries
  function add(title, hook, analysis, palette){
    d[canon(title)] = {hook, analysis, palette};
  }

  add('Impression, Sunrise',
`From a harbor wrapped in morning haze, a small orange sun ignites sky and water with a single pulse of color.`,
`At Le Havre Monet reduces the world to air and temperature. The tiny sun and its reflection are the picture’s axis; by placing a warm high-chroma note inside cool greys, he measures the hour more honestly than detail could. The dot reads as ignition—a modern day rising, industrial stacks in the mist.`,
['#FF6A00','#FF7F32','#FF9E57','#FFB347','#C85A2E']);

  add('The Fighting Temeraire',
`An old warship glides toward its twilight under a furnace sky—beauty and elegy in one sunset.`,
`Turner paints farewell and modernity together: a pale hero-ship towed by a sooty tug beneath “deeply crimsoned” clouds. The oranges are not incidental—they are the emotional core, a chosen exaggeration to make time visible. Orange is dusk, memory, and radiance at once; the ship becomes a spectral monument against a world turning to steam.`,
['#FFD6A5','#FF9900','#FF4500','#B87333','#8B4513']);

  add('Orange and Yellow',
`Two weightless fields—yellow above, orange below—breathe against each other until the air itself seems coloured.`,
`No objects—only atmosphere. The orange panel is presence and temperature; yellow is light. Where they touch, a seam of vibration forms. Feeling arrives without a story: steadiness from the orange, lift from the yellow, stillness charged with life.`,
['#FFA826','#FFD24A','#FFE38A','#FF8A33','#FFF3C1']);

  add('South Wind, Clear Sky',
`After a cloudless night and south wind, Fuji’s flank flares vermilion.`,
`One chromatic event tells weather, hour, and presence: warm banding across the slope against a cool, lifting sky. Constancy quickened by time; orange as revelation rather than ornament.`,
['#C94F2D','#D9642A','#E87334','#F08A3C','#F4A460']);

  add('Red Canna',
`Petals swell into landscape—scarlet and tangerine fold until the bloom reads as heat and breath.`,
`Enlarged and cropped, the flower becomes terrain. Orange is vitality: concentrated at the core, released along lit edges. The colour refuses to be background; it is the subject, turning a blossom into an experience of radiance.`,
['#B22222','#FF4500','#FF8C00','#FFA07A','#FFD1A1']);

  add('Composition VIII',
`Circles and vectors stage a geometric conversation; orange is the warm bass note that keeps the score humane.`,
`The space is relational, not perspectival. Orange anchors intersections and dilates light at edges; against cool blues and sharp blacks it prevents brittleness—structure with a pulse.`,
['#E67E22','#FFA500','#FFB347','#F4A460','#D2691E']);

  add('Synchromy in Orange: To Form',
`Bands and arcs hinge around an orange key, as if a chord were struck and space answered.`,
`Synchromism treats colour like music. Orange provides the tonic while complementary cools make it flare and recede rhythmically. The eye traverses temperature and value—movement felt in the body.`,
['#FFA500','#FF8C00','#FFB347','#E67E22','#F4A460']);

  add('Target with Four Faces',
`A cool, impersonal target—concentric bands including a humming orange—beneath a box of cropped faces.`,
`Encaustic traps newsprint and brushwork beneath a literal surface. Orange is attention and temperature inside an otherwise impartial schema. Between hot chroma and blind portrait, Johns stages the tension of public sign vs. private body.`,
['#FFA500','#FF8C00','#FF7F50','#F4A460','#E07A5F']);

  add('Beginning',
`Concentric rings focus on a vermilion-orange core—colour as genesis.`,
`Stain painting makes colour atmosphere. A hot nucleus set against complement and raw canvas reads like first light. Orange functions as first cause, a centring dawn note.`,
['#E34A33','#FFA500','#F5D0A9','#F4A460','#000000']);

  add('The Night Café',
`Orange and green collide in a feverish nocturne; gaslight glows like a low-grade fever.`,
`Van Gogh paints moral temperature via complements—vermilion walls against poisonous green. Orange here is not comfort but warning; pressed against green it becomes nauseating, the glow of a night that won’t end.`,
['#FF6347','#FF4500','#CD5C5C','#FF8C00','#C04000']);

  add('Bedroom in Arles',
`A simple room tilts toward us; orange wood glows against cool walls until the space feels steadfast.`,
`Lines are emphatic, shadows simplified. Orange carries presence and use; blue steadies. A portrait of rest carved from two complementary families.`,
['#FF9E57','#F4A460','#E0702A','#C68642','#8B4513']);

  add('Flaming June',
`A young woman sleeps wrapped in translucent orange silk, glowing like embers against marble and sea.`,
`Academic craft meets a chromatic dare: orange must carry the scene. Glazes stack until the drapery appears lit from within—beauty, warmth, and danger intertwined.`,
['#FF7F50','#FFA500','#E97451','#FFDAB9','#CD5C5C']);

  return d;
})();

/* ------- try to merge Picture_desc.txt overrides if present ------- */
async function loadMergedDescriptions(){
  const text = await (async()=>{
    try{ const r = await fetch('Picture_desc.txt',{cache:'no-store'}); if(r.ok) return await r.text(); }
    catch(e){}
    const el = document.getElementById('desc-data'); return el?el.textContent:'';
  })();
  if(!text) return DESCRIPTIONS;

  const t = text.replace(/\r/g,'');
  const parts = t.split(/\n(?=\d+\.\s+)/);
  const merged = {...DESCRIPTIONS};
  for(const chunk of parts){
    const head = chunk.match(/^\s*(\d+)\.\s*(.+)\n/); if(!head) continue;
    const titleLine = head[2].trim();
    const key = canon(
      titleLine
        .replace(/\s*[—–-].*$/, '')
        .replace(/\s*\(c\.\s*\d+\)\s*$/i,'')
        .replace(/\s*\(\d{4}\)\s*$/,'')
    );
    const hook = (chunk.match(/Hook:\s*([\s\S]*?)(?:\n\n|Analysis:|\nDominant Orange Palette:|$)/i)||[])[1]?.trim()||'';
    const analysis = (chunk.match(/Analysis:\s*([\s\S]*?)(?:\n\nDominant Orange Palette:|\nDominant Orange Palette:|$)/i)||[])[1]?.trim()||hook;
    const palette = [...chunk.matchAll(/#[0-9a-f]{6}/gi)].map(m=>m[0].toUpperCase());
    merged[key] = {hook, analysis, palette:[...new Set(palette)]};
  }
  return merged;
}

/* paragraphs */
function asParagraphs(txt){
  const esc = s => s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
  const t = (txt||'').trim(); if(!t) return '';
  return '<p>'+esc(t).replace(/\n{2,}/g,'</p><p>').replace(/\n/g,'<br>')+'</p>';
}

/* ------- UI hooks ------- */
const track = document.getElementById('track');
const descEl = document.getElementById('desc');
let activeIndex = 0;
let LOOKUP = DESCRIPTIONS; // will be replaced by merged map on build()

async function build(){
  LOOKUP = await loadMergedDescriptions();

  track.appendChild(Object.assign(document.createElement('div'),{className:'spacer'}));
  PAINTINGS.forEach((p,i)=>{
    const card=document.createElement('div'); card.className='card'; card.dataset.index=i;
    const img=new Image(); img.decoding='async';
    img.onload=()=>card.appendChild(img);
    img.onerror=()=>{ card.classList.add('ph'); card.innerHTML=`<div>No image<br><small>${p.title}</small></div>`; };
    img.src=p.src;

    // Single tap: center → expand
    card.addEventListener('click', ()=>{
      const cards=[...track.querySelectorAll('.card')];
      activeIndex=i;
      cards[i]?.scrollIntoView({behavior:'smooth', inline:'center', block:'nearest'});
      setTimeout(()=>openModal(), 220);
      updateCaption();
    }, {passive:true});

    track.appendChild(card);
  });
  track.appendChild(Object.assign(document.createElement('div'),{className:'spacer'}));
  requestAnimationFrame(updateScales);
  updateCaption();
}

function cssVar(n){return parseFloat(getComputedStyle(document.documentElement).getPropertyValue(n));}
function updateScales(){
  const cards=[...track.querySelectorAll('.card')]; if(!cards.length) return;
  const cx=track.clientWidth/2, base=track.scrollLeft; let best=0, bestD=1e9;
  cards.forEach((el,i)=>{
    const mid=el.offsetLeft+el.offsetWidth/2-base;
    const d=Math.abs(mid-cx);
    if(d<bestD){bestD=d; best=i;}
    const s=cssVar('--scaleCenter')-(cssVar('--scaleCenter')-cssVar('--scaleSide'))*Math.min(1,d/(track.clientWidth*.5));
    el.style.transform=`scale(${s.toFixed(3)})`;
    el.style.zIndex=String(1000-Math.round(d));
  });
  if(best!==activeIndex){ activeIndex=best; updateCaption(); }
}

function entryFor(title){
  const k = canon(title);
  return LOOKUP[k] || LOOKUP[canon(ALIAS[k]||'')] || null;
}
function updateCaption(){
  const p=PAINTINGS[activeIndex]; if(!p) return;
  const d=entryFor(p.title);
  const short=d?.hook || '—';   /* we will not show "Description coming soon" anymore */
  descEl.innerHTML=`<div class="head">${p.title} — ${p.artist} ${p.year?`(${p.year})`:''}</div>
                    <div class="body">${short}</div>`;
}

/* modal */
const modal=document.getElementById('modal');
const mWrap=document.getElementById('mWrap');
const mImg=document.getElementById('mImg');
const mTitle=document.getElementById('mTitle');
const mLong=document.getElementById('mLong');
const sw=document.getElementById('swatches');

function openModal(){
  const p=PAINTINGS[activeIndex];
  const d=entryFor(p.title);
  const card=track.querySelectorAll('.card')[activeIndex];
  const img=card?.querySelector('img');

  mImg.src=img?.src||''; mImg.alt=`${p.title} — full view`;
  mTitle.textContent=`${p.title} — ${p.artist}${p.year?', '+p.year:''}`;

  const body = d ? (d.analysis || d.hook || '') : '';
  mLong.innerHTML = asParagraphs(body);

  sw.innerHTML='';
  (d?.palette||[]).forEach(hex=>{
    const chip=document.createElement('span'); chip.className='sw';
    const fill=document.createElement('i'); fill.style.background=hex; chip.appendChild(fill);
    sw.appendChild(chip);
  });

  modal.classList.add('show');
}
modal.addEventListener('click',()=>modal.classList.remove('show'),{passive:true});

/* swipe in fullscreen */
let sx=0,sy=0,dx=0,dy=0;
mWrap.addEventListener('touchstart',e=>{const t=e.touches[0]; sx=t.clientX; sy=t.clientY;},{passive:true});
mWrap.addEventListener('touchmove',e=>{const t=e.touches[0]; dx=t.clientX-sx; dy=t.clientY-sy;},{passive:true});
mWrap.addEventListener('touchend',()=>{
  if(Math.abs(dx)>40 && Math.abs(dx)>Math.abs(dy)){
    activeIndex=(activeIndex+(dx<0?1:-1)+PAINTINGS.length)%PAINTINGS.length;
    openModal();
  }
  dx=dy=0;
},{passive:true});

/* start */
document.addEventListener('DOMContentLoaded', build);
</script>

<!-- ===== OPTIONAL EMBEDDED FALLBACK =====
     If you open this file locally (file://), the app uses the block below.
     On GitHub Pages it will use Picture_desc.txt at repo root if present.  -->
<script id="desc-data" type="text/plain">
<!-- You can paste the same numbered entries you keep in Picture_desc.txt here for offline use. -->
</script>
</body>
</html>
